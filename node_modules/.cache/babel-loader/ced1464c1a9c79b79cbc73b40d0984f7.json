{"remainingRequest":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\EcomerceFrontend\\node_modules\\babel-loader\\lib\\index.js!D:\\kevin\\proyectos\\vue\\trovare_frontend\\EcomerceFrontend\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\kevin\\proyectos\\vue\\trovare_frontend\\EcomerceFrontend\\src\\store\\modules\\main\\carrito.js","dependencies":[{"path":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\EcomerceFrontend\\src\\store\\modules\\main\\carrito.js","mtime":1569947667863},{"path":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\EcomerceFrontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\EcomerceFrontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\EcomerceFrontend\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:\\\\kevin\\\\proyectos\\\\vue\\\\trovare_frontend\\\\EcomerceFrontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Promise from \"D:\\\\kevin\\\\proyectos\\\\vue\\\\trovare_frontend\\\\EcomerceFrontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/promise\";\nimport Vue from 'vue';\nimport { pedidoUrl, carritoUrl, pedidoByUserIdUrl, directionUrl } from '../../../packages/config';\nvar state = {\n  pedido: null,\n  carrito: [],\n  new_direction: {\n    name: '',\n    direction: '',\n    latitud: '',\n    longitud: '',\n    phone_number: ''\n  },\n  directions: []\n};\nvar getters = {\n  searchCarritoById: function searchCarritoById(state) {\n    return function (product_id) {\n      return state.carrito.filter(function (cart) {\n        return cart.product_id === product_id;\n      });\n    };\n  },\n  getCantidadCarrito: function getCantidadCarrito(state) {\n    var cantitad_total = 0;\n\n    for (var x = 0; x < state.carrito.length; x++) {\n      cantitad_total = cantitad_total + state.carrito[x].quantity;\n    }\n\n    return cantitad_total;\n  },\n  getSubtotalCarrito: function getSubtotalCarrito(state) {\n    var subtotal = 0;\n\n    for (var x = 0; x < state.carrito.length; x++) {\n      subtotal = subtotal + state.carrito[x].price * state.carrito[x].quantity;\n    }\n\n    return subtotal;\n  },\n  getPosition: function getPosition(state) {}\n};\nvar mutations = {\n  selectPedidoByUserId: function selectPedidoByUserId(state, response) {\n    if (response !== null) {\n      state.pedido = response;\n      localStorage.setItem('pedido_id', response.id);\n    }\n  },\n  selectCarritoByPedidoId: function selectCarritoByPedidoId(state, response) {\n    // state.carrito = []\n    state.carrito = response;\n  },\n  addCarrito: function addCarrito(state, response) {\n    state.carrito = response; // var cambio = false\n    // if (state.carrito.length > 0){\n    //     // console.log('entra a verificar')\n    //     const index = state.carrito.findIndex(item => item.product_id === response.product_id);\n    //     if(index > 0){\n    //         Vue.set(state.carrito, index, response)\n    //         cambio = true\n    //     }\n    // }\n    // if(!cambio){\n    //     // console.log('entra a pushear')\n    //     state.carrito.push(response)\n    // }\n  },\n  createPedido: function createPedido(state, response) {\n    state.pedido = response;\n    localStorage.setItem('pedido_id', response.id);\n  },\n  getDirectionsByUserId: function getDirectionsByUserId(state, response) {\n    state.directions = response;\n  },\n  name: function name(state, changeDirection) {\n    state.new_direction.name = changeDirection;\n  },\n  direction: function direction(state, changeDirection) {\n    state.new_direction.direction = changeDirection;\n  },\n  phone_number: function phone_number(state, changeDirection) {\n    state.new_direction.phone_number = changeDirection;\n  },\n  latitud_latitud: function latitud_latitud(state, objPosition) {\n    state.new_direction.latitud = objPosition.latitud;\n    state.new_direction.longitud = objPosition.longitud;\n  },\n  selectDirection: function selectDirection(state, direction_id) {\n    state.pedido.direction_id = direction_id;\n  },\n  insertDirection: function insertDirection(state, objDirection) {\n    state.new_direction = objDirection;\n  },\n  updatePedido: function updatePedido(state, objPedido) {\n    state.pedido = objPedido;\n  }\n};\nvar actions = {\n  selectPedidoByUserId: function selectPedidoByUserId(context) {\n    var _this = this;\n\n    return new _Promise(function (resolve, reject) {\n      _this.$myApi.get(pedidoByUserIdUrl).then(function (response) {\n        resolve(response.data.pedido); // console.log('pedido',response.data.pedido)\n\n        context.commit('selectPedidoByUserId', response.data.pedido);\n      }).catch(function (error) {\n        // console.log(error)\n        reject(error);\n      });\n    });\n  },\n  selectCarritoByPedidoId: function selectCarritoByPedidoId(context, pedido_id) {\n    var _this2 = this;\n\n    return new _Promise(function (resolve, reject) {\n      _this2.$myApi.get(carritoUrl + '/' + pedido_id).then(function (response) {\n        // console.log('carrito1',response.data.carrito)\n        resolve(response.data.carrito);\n        context.commit('selectCarritoByPedidoId', response.data.carrito);\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  addCarrito: function addCarrito(_ref, obj) {\n    var dispatch = _ref.dispatch,\n        getters = _ref.getters;\n    var cartObtained = getters.searchCarritoById(obj.product.id);\n    var objCart = {\n      product_id: obj.product.id,\n      pedido_id: obj.pedido.id,\n      quantity: obj.cantidadSelected,\n      price: obj.product.price\n    };\n\n    if (cartObtained.length > 0) {\n      var sumQuantity = cartObtained[0].quantity + obj.cantidadSelected;\n\n      if (sumQuantity <= obj.product.quantity && sumQuantity > cartObtained[0].quantity) {\n        objCart.quantity = sumQuantity;\n        dispatch('createAndUpdateCarrito', objCart);\n      } else {\n        console.log('no se puede a;adir mas de ' + obj.product.quantity + 'items');\n      }\n    } else {\n      dispatch('createAndUpdateCarrito', objCart);\n    }\n  },\n  createPedido: function () {\n    var _createPedido = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee(context) {\n      var response;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return this.$myApi.post(pedidoUrl);\n\n            case 3:\n              response = _context.sent;\n              context.commit('createPedido', response.data.pedido);\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[0, 7]]);\n    }));\n\n    function createPedido(_x) {\n      return _createPedido.apply(this, arguments);\n    }\n\n    return createPedido;\n  }(),\n  createAndUpdateCarrito: function createAndUpdateCarrito(context, obj) {\n    var _this3 = this;\n\n    return new _Promise(function (resolve, reject) {\n      _this3.$myApi.post(carritoUrl, {\n        product_id: obj.product_id,\n        pedido_id: obj.pedido_id,\n        quantity: obj.quantity,\n        price: obj.price\n      }).then(function (response) {\n        context.commit('addCarrito', response.data.carrito);\n        resolve(response);\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  eliminarItem: function eliminarItem(_ref2, obj) {\n    var _this4 = this;\n\n    var dispatch = _ref2.dispatch;\n    return new _Promise(function (resolve, reject) {\n      _this4.$myApi.delete(carritoUrl + '/' + obj.product_id + '/' + obj.pedido_id).then(function (response) {\n        if (response.data.deleted) {\n          dispatch('selectCarritoByPedidoId', obj.pedido_id);\n        }\n\n        resolve(response.data.deleted);\n      }).catch(function (error) {\n        reject(error);\n      });\n    });\n  },\n  getDirectionsByUserId: function getDirectionsByUserId(context) {\n    var _this5 = this;\n\n    return new _Promise(function (resolve, reject) {\n      _this5.$myApi.get(directionUrl).then(function (response) {\n        if (response.data.direction != null) {\n          context.commit('getDirectionsByUserId', response.data.direction);\n        }\n      });\n    }).catch(function (error) {\n      reject(error);\n    });\n  },\n  selectDirection: function selectDirection(context, direction_id) {\n    return new _Promise(function (resolve, reject) {\n      context.commit('selectDirection', direction_id);\n      resolve(true);\n    }).catch(function (error) {\n      reject(error);\n    });\n  },\n  insertDirection: function insertDirection(_ref3) {\n    var _this6 = this;\n\n    var state = _ref3.state,\n        commit = _ref3.commit;\n    return new _Promise(function (resolve, reject) {\n      _this6.$myApi.post(directionUrl, state.new_direction).then(function (response) {\n        if (response.data.direction != null) {\n          commit('insertDirection', response.data.direction);\n          resolve(response.data.direction);\n        }\n      });\n    }).catch(function (error) {\n      reject(error);\n    });\n  },\n  updatePedido: function updatePedido(_ref4) {\n    var state = _ref4.state,\n        commit = _ref4.commit;\n    this.$myApi.post(pedidoUrl, state.pedido).then(function (response) {\n      if (response.data.direction != null) {\n        commit('updatePedido', response.data.direction);\n      }\n    });\n  }\n};\nexport default {\n  state: state,\n  getters: getters,\n  mutations: mutations,\n  actions: actions\n};",{"version":3,"sources":["D:\\kevin\\proyectos\\vue\\trovare_frontend\\EcomerceFrontend\\src\\store\\modules\\main\\carrito.js"],"names":["Vue","pedidoUrl","carritoUrl","pedidoByUserIdUrl","directionUrl","state","pedido","carrito","new_direction","name","direction","latitud","longitud","phone_number","directions","getters","searchCarritoById","product_id","filter","cart","getCantidadCarrito","cantitad_total","x","length","quantity","getSubtotalCarrito","subtotal","price","getPosition","mutations","selectPedidoByUserId","response","localStorage","setItem","id","selectCarritoByPedidoId","addCarrito","createPedido","getDirectionsByUserId","changeDirection","latitud_latitud","objPosition","selectDirection","direction_id","insertDirection","objDirection","updatePedido","objPedido","actions","context","resolve","reject","$myApi","get","then","data","commit","catch","error","pedido_id","obj","dispatch","cartObtained","product","objCart","cantidadSelected","sumQuantity","console","log","post","createAndUpdateCarrito","eliminarItem","delete","deleted"],"mappings":"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","sourcesContent":["import Vue from 'vue'\r\nimport {pedidoUrl, carritoUrl,pedidoByUserIdUrl,directionUrl} from '../../../packages/config'\r\n\r\nconst state = {\r\n    pedido : null,\r\n    carrito :[],\r\n    new_direction:{\r\n        name:'',\r\n        direction:'',\r\n        latitud:'',\r\n        longitud:'',\r\n        phone_number:''\r\n    },\r\n    directions : []\r\n}\r\n\r\nconst getters = {\r\n    searchCarritoById: state => product_id => {\r\n        return state.carrito.filter(cart => cart.product_id === product_id)\r\n    },\r\n    getCantidadCarrito(state){\r\n        var cantitad_total = 0\r\n        for (let x = 0; x < state.carrito.length; x++) {\r\n            cantitad_total = cantitad_total + state.carrito[x].quantity\r\n        }\r\n        return cantitad_total\r\n    },\r\n    getSubtotalCarrito(state){\r\n        var subtotal = 0\r\n        for (let x = 0; x < state.carrito.length; x++) {\r\n            subtotal = subtotal + (state.carrito[x].price *state.carrito[x].quantity)\r\n        }\r\n        return subtotal\r\n    },\r\n  \r\n    getPosition(state){\r\n\r\n    }\r\n}\r\n\r\nconst mutations = {\r\n    selectPedidoByUserId(state,response){\r\n        if(response !==null){\r\n            state.pedido = response\r\n            localStorage.setItem('pedido_id', response.id)\r\n        }\r\n    },\r\n    selectCarritoByPedidoId(state, response){\r\n            // state.carrito = []\r\n            state.carrito = response\r\n    },\r\n    addCarrito(state, response){\r\n        state.carrito = response\r\n        // var cambio = false\r\n        // if (state.carrito.length > 0){\r\n        //     // console.log('entra a verificar')\r\n        //     const index = state.carrito.findIndex(item => item.product_id === response.product_id);\r\n        //     if(index > 0){\r\n        //         Vue.set(state.carrito, index, response)\r\n        //         cambio = true\r\n        //     }\r\n        // }\r\n        // if(!cambio){\r\n        //     // console.log('entra a pushear')\r\n        //     state.carrito.push(response)\r\n        // }\r\n    },\r\n    createPedido(state, response){\r\n        state.pedido = response\r\n        localStorage.setItem('pedido_id', response.id)\r\n    },\r\n\r\n    getDirectionsByUserId(state,response){\r\n        state.directions = response\r\n    },\r\n    name (state, changeDirection) {\r\n        state.new_direction.name = changeDirection\r\n    },\r\n    direction (state, changeDirection) {\r\n        state.new_direction.direction = changeDirection\r\n    },\r\n    phone_number (state, changeDirection) {\r\n        state.new_direction.phone_number = changeDirection\r\n    },\r\n    latitud_latitud (state, objPosition) {\r\n        state.new_direction.latitud = objPosition.latitud\r\n        state.new_direction.longitud = objPosition.longitud\r\n    },\r\n    selectDirection(state, direction_id){\r\n        state.pedido.direction_id = direction_id\r\n    },\r\n    insertDirection(state, objDirection){\r\n        state.new_direction = objDirection\r\n    },\r\n    updatePedido(state, objPedido){\r\n        state.pedido = objPedido\r\n    }\r\n}\r\n\r\nconst actions = {\r\n    selectPedidoByUserId(context){\r\n        return new Promise((resolve, reject) => {\r\n            this.$myApi.get(pedidoByUserIdUrl)\r\n            .then(response=>{\r\n                resolve(response.data.pedido)\r\n                // console.log('pedido',response.data.pedido)\r\n                context.commit('selectPedidoByUserId',response.data.pedido)\r\n            }) \r\n            .catch(error =>{\r\n                // console.log(error)\r\n                reject(error)\r\n            })\r\n        })\r\n    },\r\n    selectCarritoByPedidoId(context, pedido_id){\r\n        return new Promise((resolve, reject) => {\r\n            this.$myApi.get(carritoUrl + '/'+ pedido_id)\r\n            .then(response =>{\r\n                // console.log('carrito1',response.data.carrito)\r\n                resolve(response.data.carrito)\r\n                context.commit('selectCarritoByPedidoId',response.data.carrito)\r\n            }).catch(error =>{\r\n                reject(error)\r\n            })\r\n        })\r\n    },\r\n\r\n    addCarrito({ dispatch, getters },obj){\r\n        var cartObtained = getters.searchCarritoById(obj.product.id)\r\n        let objCart = {\r\n                        product_id:     obj.product.id, \r\n                        pedido_id:      obj.pedido.id,\r\n                        quantity:       obj.cantidadSelected,\r\n                        price:          obj.product.price,\r\n                    }\r\n        if(cartObtained.length > 0 ){\r\n            var sumQuantity = cartObtained[0].quantity + obj.cantidadSelected\r\n            if(sumQuantity <= obj.product.quantity && sumQuantity > cartObtained[0].quantity){\r\n                objCart.quantity = sumQuantity\r\n                dispatch('createAndUpdateCarrito',objCart)\r\n            }else{\r\n                console.log('no se puede a;adir mas de ' +  obj.product.quantity + 'items' )\r\n            }\r\n        } else{\r\n            dispatch('createAndUpdateCarrito',objCart)\r\n        }\r\n    },\r\n    async createPedido(context){\r\n        try{\r\n            let response = await this.$myApi.post(pedidoUrl)\r\n            context.commit('createPedido',response.data.pedido)\r\n        }catch(ex){\r\n            console.log(ex)\r\n        }\r\n        // this.$myApi.post(pedidoUrl)\r\n        // .then(response=>{\r\n        //     // console.log('pedido',response.data.pedido)\r\n        //     context.commit('createPedido',response.data.pedido)\r\n        // })\r\n    },\r\n    createAndUpdateCarrito(context, obj){\r\n        return new Promise((resolve, reject) => {\r\n            this.$myApi.post(carritoUrl,{\r\n            product_id:     obj.product_id,\r\n            pedido_id:      obj.pedido_id,\r\n            quantity:       obj.quantity,\r\n            price:          obj.price,\r\n            })\r\n            .then(response =>{\r\n                context.commit('addCarrito',response.data.carrito)\r\n                resolve(response)\r\n            })\r\n            .catch(error =>{\r\n                reject(error)\r\n            })\r\n        })\r\n    },\r\n    eliminarItem({dispatch}, obj){\r\n        return new Promise((resolve, reject) => {\r\n            this.$myApi.delete(carritoUrl+'/'+obj.product_id+'/'+obj.pedido_id)\r\n            .then(response =>{\r\n                if(response.data.deleted){\r\n                    dispatch('selectCarritoByPedidoId',obj.pedido_id)\r\n                }\r\n                resolve(response.data.deleted)\r\n            })\r\n            .catch(error =>{\r\n                reject(error)\r\n            })\r\n        })\r\n    },\r\n    getDirectionsByUserId(context){\r\n        return new Promise((resolve, reject) => {\r\n            this.$myApi.get(directionUrl)\r\n            .then(response =>{\r\n                if(response.data.direction != null){\r\n                    context.commit('getDirectionsByUserId',response.data.direction)\r\n                }\r\n            })\r\n        })\r\n        .catch(error =>{\r\n            reject(error)\r\n        })\r\n    },\r\n    selectDirection(context,direction_id){\r\n        return new Promise((resolve, reject) => {\r\n            context.commit('selectDirection',direction_id)\r\n            resolve(true)\r\n        })\r\n        .catch(error =>{\r\n            reject(error)\r\n        })\r\n    },\r\n    insertDirection({ state, commit }){\r\n        return new Promise((resolve, reject) => {\r\n            this.$myApi.post(directionUrl,state.new_direction)\r\n            .then(response =>{\r\n                if(response.data.direction != null){\r\n                    commit('insertDirection',response.data.direction)\r\n                    resolve(response.data.direction)\r\n                }\r\n            })\r\n        })\r\n        .catch(error =>{\r\n            reject(error)\r\n        })\r\n    },\r\n    updatePedido({ state, commit }){\r\n        this.$myApi.post(pedidoUrl,state.pedido)\r\n        .then(response =>{\r\n            if(response.data.direction != null){\r\n                commit('updatePedido',response.data.direction)\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n\r\nexport default{\r\n    state, getters, mutations, actions\r\n}\r\n"]}]}