{"remainingRequest":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\node_modules\\babel-loader\\lib\\index.js!D:\\kevin\\proyectos\\vue\\trovare_frontend\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\kevin\\proyectos\\vue\\trovare_frontend\\src\\store\\modules\\admin\\product.js","dependencies":[{"path":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\src\\store\\modules\\admin\\product.js","mtime":1553870447677},{"path":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\kevin\\proyectos\\vue\\trovare_frontend\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Promise from \"D:\\\\kevin\\\\proyectos\\\\vue\\\\trovare_frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/promise\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:\\\\kevin\\\\proyectos\\\\vue\\\\trovare_frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"D:\\\\kevin\\\\proyectos\\\\vue\\\\trovare_frontend\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.function.name\";\nimport axios from 'axios';\nimport * as firebase from 'firebase';\nimport { getField, updateField } from 'vuex-map-fields';\nimport { productUrl, characteristicUrl, fileUrl, categoryUrl, statusProductUrl } from '../../../packages/config';\nimport { async } from 'q';\nvar strict = true;\nvar state = {\n  products: [],\n  productObj: {\n    generateUuid: '',\n    id: null,\n    name: '',\n    modelo: '',\n    quantity: '',\n    brand: '',\n    price: '',\n    category_id: null,\n    // category_id:undefined,\n    peso: '',\n    alto: '',\n    ancho: '',\n    fondo: '',\n    parent_id: 0,\n    // statusProduct_id:null,\n    statusProduct_id: null,\n    description: '' // uniqueCode:'',\n\n  },\n  categories: [],\n  status: [],\n  characteristics: [{\n    id: '',\n    characteristicName: '',\n    state: 'new'\n  }],\n  files: [{\n    id: '',\n    name: '',\n    file: '',\n    url: '',\n    uuid: '',\n    state: 'new'\n  }],\n  fileForDelete: [],\n  maxUploadImage: 4,\n  userFirebase: 'kevi3195@gmail.com',\n  passFirebase: 'secret!123'\n};\nvar getters = {\n  getField: getField,\n  fileGetter: function fileGetter(state) {\n    return state.files;\n  },\n  ProductGetter: function ProductGetter(state) {\n    return state.products;\n  },\n  categoriesGetter: function categoriesGetter(state) {\n    return state.categories;\n  },\n  statusGetter: function statusGetter(state) {\n    return state.status;\n  }\n};\nvar mutations = {\n  updateField: updateField,\n  fillcategories: function fillcategories(state, response) {\n    state.categories = response;\n  },\n  fillStatus: function fillStatus(state, response) {\n    state.status = response;\n  },\n  addCharacteristic: function addCharacteristic(state) {\n    state.characteristics.push({\n      id: '',\n      characteristicName: '',\n      state: 'new'\n    });\n  },\n  fillProducts: function fillProducts(state, response) {\n    state.products = response;\n  },\n  fillProductById: function fillProductById(state, response) {\n    state.productObj = _defineProperty({\n      generateUuid: '',\n      id: response.id,\n      name: response.name,\n      modelo: response.modelo,\n      brand: response.brand,\n      category_id: response.category_id,\n      quantity: response.quantity,\n      price: response.price,\n      peso: response.peso,\n      alto: response.alto,\n      ancho: response.ancho,\n      fondo: response.fondo,\n      statusProduct_id: response.statusProduct_id,\n      description: response.description,\n      parent_id: 0\n    }, \"description\", response.description);\n  },\n  fillCharacteristicByProductId: function fillCharacteristicByProductId(state, response) {\n    var arrayOfCharacteristic = [];\n\n    for (var index = 0; index < response.length; index++) {\n      var element = response[index];\n      arrayOfCharacteristic.push({\n        id: element.id,\n        characteristicName: element.characteristic,\n        state: 'edit'\n      });\n    }\n\n    state.characteristics = arrayOfCharacteristic;\n  },\n  fillFileByProductId: function fillFileByProductId(state, response) {\n    var arrayOfFile = [];\n\n    for (var index = 0; index < response.length; index++) {\n      var element = response[index];\n      arrayOfFile.push({\n        id: element.id,\n        name: element.name,\n        file: '',\n        url: element.path,\n        uuid: '',\n        state: 'old'\n      });\n    }\n\n    state.files = arrayOfFile;\n  },\n  putImage: function putImage(state, response) {\n    var element = state.files[response.index];\n    var estado = 'new';\n\n    if (element.state == 'old') {\n      var objfileDelete = {\n        id: element.id,\n        url: element.url\n      };\n      state.fileForDelete.push(objfileDelete);\n      estado = 'new';\n    }\n\n    element.id = '';\n    element.name = '';\n    element.file = response.file;\n    element.url = response.url;\n    element.uuid = response.uuid;\n    element.state = estado;\n  },\n  deleteCharacteristic: function deleteCharacteristic(state, objCharact) {\n    var estado = objCharact.state;\n    var index = objCharact.index;\n\n    if (estado == 'edit' && state.characteristics[index].state == 'edit') {\n      // console.log(index)\n      state.characteristics[index].state = 'delete';\n    } else if (state.characteristics[index].state == 'new' || state.characteristics[index].state == 'delete') {\n      state.characteristics.splice(index, 1);\n    }\n  },\n  //------------llenado de producto------------\n  generateUuid: function generateUuid(state, AddProductObj) {\n    state.productObj.generateUuid = AddProductObj;\n  },\n  NameProduct: function NameProduct(state, AddProductObj) {\n    state.productObj.name = AddProductObj;\n  },\n  modeloProduct: function modeloProduct(state, AddProductObj) {\n    state.productObj.modelo = AddProductObj;\n  },\n  quantityProduct: function quantityProduct(state, AddProductObj) {\n    state.productObj.quantity = AddProductObj;\n  },\n  brandProduct: function brandProduct(state, AddProductObj) {\n    state.productObj.brand = AddProductObj;\n  },\n  priceProduct: function priceProduct(state, AddProductObj) {\n    state.productObj.price = AddProductObj;\n  },\n  category_idProduct: function category_idProduct(state, AddProductObj) {\n    state.productObj.category_id = AddProductObj;\n  },\n  pesoProduct: function pesoProduct(state, AddProductObj) {\n    state.productObj.peso = AddProductObj;\n  },\n  altoProduct: function altoProduct(state, AddProductObj) {\n    state.productObj.alto = AddProductObj;\n  },\n  anchoProduct: function anchoProduct(state, AddProductObj) {\n    state.productObj.ancho = AddProductObj;\n  },\n  fondoProduct: function fondoProduct(state, AddProductObj) {\n    state.productObj.fondo = AddProductObj;\n  },\n  parent_idProduct: function parent_idProduct(state, AddProductObj) {\n    state.productObj.parent_id = AddProductObj;\n  },\n  statusProduct_idProduct: function statusProduct_idProduct(state, AddProductObj) {\n    state.productObj.statusProduct_id = AddProductObj;\n  },\n  updateDescription: function updateDescription(state, AddProductObj) {\n    state.productObj.description = AddProductObj;\n  },\n  //---------------------------------------------------\n  //---------------adicionando imagen------------------\n  deleteFileImage: function deleteFileImage(state, index) {\n    var element = state.files[index];\n\n    if (element.state == 'old') {\n      var objfileDelete = {\n        id: element.id,\n        name: element.name,\n        url: element.url\n      };\n      state.fileForDelete.push(objfileDelete);\n    }\n\n    state.files.splice(index, 1);\n  },\n  CreateAndUpdateProductSubmit: function CreateAndUpdateProductSubmit(state, productId) {\n    state.productObj.id = productId;\n  },\n  clearFields: function clearFields(state) {\n    state.productObj = {\n      generateUuid: '',\n      id: null,\n      name: '',\n      modelo: '',\n      quantity: '',\n      brand: '',\n      price: '',\n      category_id: null,\n      peso: '',\n      alto: '',\n      ancho: '',\n      fondo: '',\n      parent_id: 0,\n      statusProduct_id: null,\n      description: ''\n    }, state.categories = [], state.status = [], state.characteristics = [{\n      id: '',\n      characteristicName: '',\n      state: 'new'\n    }], state.files = [{\n      id: '',\n      name: '',\n      file: '',\n      url: '',\n      uuid: '',\n      state: 'new'\n    }, state.fileForDelete = []];\n  },\n  addFileImage: function addFileImage() {\n    state.files.push({\n      id: '',\n      name: '',\n      file: '',\n      url: '',\n      uuid: '',\n      state: 'new'\n    });\n  },\n  emptyFile: function emptyFile(state, index) {\n    var element = state.files[index];\n\n    if (element.state == 'old') {\n      var objfileDelete = {\n        id: element.id,\n        name: element.name,\n        url: element.url\n      };\n      state.fileForDelete.push(objfileDelete);\n    }\n\n    element.id = '';\n    element.url = '';\n    element.state = 'new';\n    element.uuid = '';\n  },\n  addingImageFirebase: function addingImageFirebase(state, objFile) {\n    var resultadoNew = state.files.filter(function (file) {\n      return file.state === 'new';\n    });\n    var element = resultadoNew[objFile.index];\n    element.url = objFile.urlFirebase;\n    element.name = objFile.name;\n  },\n  CreateAndUpdateCharacteristic: function CreateAndUpdateCharacteristic(state, objCharact) {\n    state.characteristics[objCharact.index].id = objCharact.id;\n  },\n  createAndUpdateFileProduct: function createAndUpdateFileProduct(state, objFile) {\n    var element = state.files[objFile.index];\n    element.id = objFile.id;\n    element.name = objFile.name;\n  },\n  deleteImageFirebaseAndDataBase: function deleteImageFirebaseAndDataBase(state) {\n    state.fileForDelete = [];\n  }\n};\nvar actions = {\n  fillcategories: function fillcategories(context) {\n    axios.get(categoryUrl).then(function (response) {\n      context.commit('fillcategories', response.data);\n    });\n  },\n  fillStatus: function fillStatus(context) {\n    axios.get(statusProductUrl).then(function (response) {\n      context.commit('fillStatus', response.data);\n    });\n  },\n  fillProducts: function fillProducts(context, auth) {\n    axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth;\n    axios.get(productUrl).then(function (response) {\n      context.commit('fillProducts', response.data);\n    });\n  },\n  fillProductById: function fillProductById(context, object) {\n    // console.log('estoy en llenado de producto', object)\n    var auth = object.auth;\n    var id = object.id;\n    axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth;\n    axios.get(productUrl + '/' + id).then(function (response) {\n      context.commit('fillProductById', response.data);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  },\n  fillCharacteristicByProductId: function fillCharacteristicByProductId(context, object) {\n    var auth = object.auth;\n    var id = object.id;\n    axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth;\n    axios.get(characteristicUrl + '/' + id).then(function (response) {\n      context.commit('fillCharacteristicByProductId', response.data);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  },\n  fillFileByProductId: function fillFileByProductId(context, object) {\n    var auth = object.auth;\n    var id = object.id;\n    axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth;\n    axios.get(fileUrl + '/' + id).then(function (response) {\n      context.commit('fillFileByProductId', response.data);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  },\n  addFile: function addFile(context, objFile) {\n    context.commit('addFile', objFile);\n  },\n  deleteCharacteristic: function deleteCharacteristic(context, objcharacteristic) {\n    context.commit('deleteCharacteristic', objcharacteristic);\n  },\n  deleteFileImage: function deleteFileImage(context, number) {\n    context.commit('deleteFileImage', number);\n  },\n  addFileImage: function addFileImage(context) {\n    context.commit('addFileImage');\n  },\n  emptyFile: function emptyFile(context, index) {\n    context.commit('emptyFile', index);\n  },\n  //creando en la base de datos\n  CreateAndUpdateProductSubmit: function () {\n    var _CreateAndUpdateProductSubmit = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee(context, object) {\n      var auth, method, id, url, data, response;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              auth = object.auth;\n              method = object.method;\n              id = object.productId;\n              url = productUrl;\n\n              if (method == 'put') {\n                url = productUrl + '/' + id;\n              } // console.log('number one')\n              // console.log(auth)\n\n\n              _context.prev = 5;\n              data = state.productObj;\n              axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth;\n              _context.next = 10;\n              return axios.post(url, {\n                name: data.name,\n                modelo: data.modelo,\n                quantity: data.quantity,\n                brand: data.brand,\n                price: data.price,\n                category_id: data.category_id,\n                peso: data.peso,\n                alto: data.alto,\n                ancho: data.ancho,\n                fondo: data.fondo,\n                parent_id: 0,\n                description: data.description,\n                statusProduct_id: data.statusProduct_id\n              });\n\n            case 10:\n              response = _context.sent;\n\n              if (response.data.create) {\n                console.log('producto registrado con exito', response.data.create);\n              }\n\n              if (response.data.update) {\n                console.log('producto actualizado con exito', response.data.update);\n              }\n\n              context.commit('CreateAndUpdateProductSubmit', response.data.product_id);\n              _context.next = 19;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](5);\n              console.log(_context.t0);\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this, [[5, 16]]);\n    }));\n\n    function CreateAndUpdateProductSubmit(_x, _x2) {\n      return _CreateAndUpdateProductSubmit.apply(this, arguments);\n    }\n\n    return CreateAndUpdateProductSubmit;\n  }(),\n  //add image in farebase\n  uploadImageFirebase: function uploadImageFirebase(context, fileForInsert) {\n    return new _Promise(function (resolve, reject) {\n      var _loop = function _loop(index) {\n        var element = fileForInsert[index];\n        var uuid = element.uuid; // console.log('element', element)\n        // console.log('uuid', uuid)\n        // console.log(state.files[index])\n\n        firebase.auth().signInWithEmailAndPassword(state.userFirebase, state.passFirebase).then(function (user) {\n          var storageRef = firebase.storage().ref();\n          var metadata = {\n            contentType: element.file[0].type\n          };\n          var filename = element.file[0].name;\n          var ext = filename.slice(filename.lastIndexOf('.'));\n          var uploadTask = storageRef.child('products/' + uuid + ext).put(element.file[0], metadata);\n          uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, function (snapshot) {\n            var progress = snapshot.bytesTransferred / snapshot.totalBytes * 100;\n            console.log('[' + index + ']' + 'Upload is ' + progress + '% done');\n\n            switch (snapshot.state) {\n              case firebase.storage.TaskState.PAUSED:\n                console.log('Upload is paused');\n                break;\n\n              case firebase.storage.TaskState.RUNNING:\n                console.log('Upload is running');\n                break;\n            }\n          }, function (error) {\n            switch (error.code) {\n              case 'storage/unauthorized':\n                // User doesn't have permission to access the object\n                break;\n\n              case 'storage/canceled':\n                // User canceled the upload\n                break;\n\n              case 'storage/unknown':\n                // Unknown error occurred, inspect error.serverResponse\n                break;\n            }\n          }, function complete() {\n            // Upload completed successfully, now we can get the download URL\n            uploadTask.snapshot.ref.getDownloadURL().then(function (downloadURL) {\n              var objectFile = {\n                index: index,\n                name: uuid + ext,\n                urlFirebase: downloadURL // //   console.log('tama;o Imagen', state.maxUploadImage-1)\n\n              };\n              context.commit('addingImageFirebase', objectFile);\n              console.log('File available at', downloadURL);\n\n              if (fileForInsert.length == index + 1) {\n                console.log('entro para que siga el procedimiento');\n                resolve(true);\n              }\n            });\n          });\n        });\n      };\n\n      for (var index = 0; index < fileForInsert.length; index++) {\n        _loop(index);\n      }\n    });\n  },\n  addingImageFirebase: function addingImageFirebase(context) {\n    return new _Promise(function (resolve, reject) {\n      var countFile = state.files.length;\n      var resultadoNew = state.files.filter(function (file) {\n        return file.state === 'new';\n      });\n\n      if (resultadoNew.length > 0) {\n        context.dispatch('uploadImageFirebase', resultadoNew).then(function (response) {\n          if (response) {\n            resolve(true);\n            console.log('entro a insertar la imagen');\n          }\n        });\n      } else {\n        resolve(true);\n        console.log('no hay que subir');\n      }\n    }); // console.log('resultado de estado mew',resultado)\n    // console.log('resultado contador de files',countFile)\n    // for (let index = 0; index < state.files.length; index++) {\n    //     const element = state.files[index];\n    //     const uuid = state.files[index].uuid ;\n    // console.log('element', element)\n    // console.log('uuid', uuid)\n    // console.log(state.files[index])\n    // if(element.state == 'new' || element.state =='update'){\n    //     context.dispatch('uploadImageFirebase',element).then((response) => {\n    //         if(index == (state.files.length-1)){\n    //             resolve(true)\n    //         }\n    //     })\n    // }\n    // }\n  },\n  CreateAndUpdateCharacteristic: function CreateAndUpdateCharacteristic(context, object) {\n    try {\n      var auth = object.auth;\n      var id = object.productId;\n      var url = '';\n      axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth;\n\n      var _loop2 = function _loop2(index) {\n        var element = state.characteristics[index];\n\n        if (element.state == 'edit' || element.state == 'new') {\n          if (element.state == 'edit') {\n            url = characteristicUrl + '/' + element.id;\n          } else if (element.state == 'new') {\n            url = characteristicUrl;\n          }\n\n          axios.post(url, {\n            product_id: state.productObj.id,\n            characteristic: element.characteristicName\n          }).then(function (response) {\n            var objCharact = {\n              id: response.data.id,\n              index: index\n            };\n            context.commit('CreateAndUpdateCharacteristic', objCharact);\n            console.log('caracteristica ' + response.data.type + ' con exito', response.data);\n          });\n        } else {\n          url = characteristicUrl + '/' + element.id;\n          axios.delete(url).then(function (response) {\n            console.log('se elimino correctamente', response);\n            var obj = {\n              index: index,\n              state: 'delete' // context.commit('deleteCharacteristic',obj)\n\n            };\n            console.log('caracteristica ' + response.data.type + ' con exito', response.data);\n          });\n        }\n      };\n\n      for (var index = 0; index < state.characteristics.length; index++) {\n        _loop2(index);\n      }\n    } catch (ex) {\n      console.log(ex);\n    }\n  },\n  createAndUpdateFileProduct: function createAndUpdateFileProduct(context, object) {\n    try {\n      var auth = object.auth;\n      var url = fileUrl;\n      axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth;\n\n      var _loop3 = function _loop3(index) {\n        var element = state.files[index];\n\n        if (element.state == 'update' || element.state == 'new') {\n          if (element.state == 'update') {\n            url = url + '/' + element.id;\n          }\n\n          axios.post(url, {\n            product_id: state.productObj.id,\n            name: element.name,\n            path: element.url\n          }).then(function (response) {\n            var objCharact = {\n              id: response.id,\n              name: response.name,\n              index: index\n            };\n            context.commit('createAndUpdateFileProduct', objCharact);\n            console.log('imagenes registradas con exito', response.data.saved);\n          });\n        }\n      };\n\n      for (var index = 0; index < state.files.length; index++) {\n        _loop3(index);\n      }\n    } catch (ex) {\n      console.log(ex);\n    }\n  },\n  deleteImageFirebaseAndDataBase: function deleteImageFirebaseAndDataBase(context, object) {\n    var auth = object.auth;\n\n    if (state.fileForDelete.length > 0) {\n      axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth;\n      firebase.auth().signInWithEmailAndPassword(state.userFirebase, state.passFirebase).then(function (user) {\n        for (var index = 0; index < state.fileForDelete.length; index++) {\n          var element = state.fileForDelete[index];\n          var storage = firebase.storage();\n          var storageRef = storage.ref();\n          var desertRef = storageRef.child('/products/' + element.name);\n          desertRef.delete().then(function () {\n            console.log('se elimino correctamente de firebase su imagen');\n          }).catch(function (error) {// Uh-oh, an error occurred!\n          });\n          axios.delete(fileUrl + '/' + element.id).then(function (response) {\n            console.log('imagen eliminada correctamente de la base de datos');\n          });\n        }\n\n        context.commit('deleteImageFirebaseAndDataBase');\n      });\n    }\n  },\n  putImage: function putImage(context, object) {\n    context.commit('putImage', object);\n  },\n  clearFields: function clearFields(context) {\n    context.commit('clearFields');\n  },\n  addCharacteristic: function addCharacteristic(context) {\n    context.commit('addCharacteristic');\n  }\n};\nexport default {\n  strict: strict,\n  state: state,\n  getters: getters,\n  mutations: mutations,\n  actions: actions\n};",{"version":3,"sources":["D:\\kevin\\proyectos\\vue\\trovare_frontend\\src\\store\\modules\\admin\\product.js"],"names":["axios","firebase","getField","updateField","productUrl","characteristicUrl","fileUrl","categoryUrl","statusProductUrl","async","strict","state","products","productObj","generateUuid","id","name","modelo","quantity","brand","price","category_id","peso","alto","ancho","fondo","parent_id","statusProduct_id","description","categories","status","characteristics","characteristicName","files","file","url","uuid","fileForDelete","maxUploadImage","userFirebase","passFirebase","getters","fileGetter","ProductGetter","categoriesGetter","statusGetter","mutations","fillcategories","response","fillStatus","addCharacteristic","push","fillProducts","fillProductById","fillCharacteristicByProductId","arrayOfCharacteristic","index","length","element","characteristic","fillFileByProductId","arrayOfFile","path","putImage","estado","objfileDelete","deleteCharacteristic","objCharact","splice","AddProductObj","NameProduct","modeloProduct","quantityProduct","brandProduct","priceProduct","category_idProduct","pesoProduct","altoProduct","anchoProduct","fondoProduct","parent_idProduct","statusProduct_idProduct","updateDescription","deleteFileImage","CreateAndUpdateProductSubmit","productId","clearFields","addFileImage","emptyFile","addingImageFirebase","objFile","resultadoNew","filter","urlFirebase","CreateAndUpdateCharacteristic","createAndUpdateFileProduct","deleteImageFirebaseAndDataBase","actions","context","get","then","commit","data","auth","defaults","headers","common","object","catch","error","console","log","addFile","objcharacteristic","number","method","post","create","update","product_id","uploadImageFirebase","fileForInsert","resolve","reject","signInWithEmailAndPassword","user","storageRef","storage","ref","metadata","contentType","type","filename","ext","slice","lastIndexOf","uploadTask","child","put","on","TaskEvent","STATE_CHANGED","snapshot","progress","bytesTransferred","totalBytes","TaskState","PAUSED","RUNNING","code","complete","getDownloadURL","downloadURL","objectFile","countFile","dispatch","delete","obj","ex","saved","desertRef"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport * as firebase from 'firebase'\r\nimport { getField, updateField } from 'vuex-map-fields';\r\nimport {productUrl,characteristicUrl,fileUrl,categoryUrl,statusProductUrl} from '../../../packages/config'\r\nimport { async } from 'q';\r\n\r\nconst strict = true\r\nconst state = {\r\n    products:[],\r\n    productObj:{\r\n        generateUuid:'',\r\n        id:null,\r\n        name: '',\r\n        modelo: '',\r\n        quantity:'',\r\n        brand:'',\r\n        price:'',\r\n        category_id:null,\r\n        // category_id:undefined,\r\n        peso:'',\r\n        alto:'',\r\n        ancho:'',\r\n        fondo:'',\r\n        parent_id:0,\r\n        // statusProduct_id:null,\r\n        statusProduct_id:null,\r\n        description:''\r\n        // uniqueCode:'',\r\n    },\r\n    categories:[],\r\n    status:[],\r\n    characteristics:[{\r\n        id:'',\r\n        characteristicName:'',\r\n        state:'new'\r\n    },\r\n   ],\r\n    files:[\r\n        {\r\n            id:'',\r\n            name:'',\r\n            file:'',\r\n            url:'',\r\n            uuid:'',\r\n            state:'new'\r\n        }\r\n    ],\r\n    fileForDelete : [],\r\n    maxUploadImage:4,\r\n    userFirebase:'kevi3195@gmail.com',\r\n    passFirebase:'secret!123'\r\n \r\n}\r\n\r\nconst getters={\r\n    getField,\r\n    fileGetter: (state) => {\r\n        return state.files\r\n      },\r\n    ProductGetter:(state)  =>{\r\n        return state.products\r\n    },\r\n    categoriesGetter:(state)=>{\r\n        return state.categories\r\n    },\r\n    statusGetter:(state)=>{\r\n        return state.status\r\n    }\r\n}\r\n\r\nconst mutations = {\r\n    updateField,\r\n    fillcategories(state,response){\r\n        state.categories = response\r\n    },\r\n    fillStatus(state,response){\r\n        state.status = response\r\n    },\r\n    addCharacteristic(state){\r\n        state.characteristics.push({\r\n            id:'',\r\n            characteristicName:'',\r\n            state:'new'\r\n        })\r\n    },\r\n    fillProducts(state,response){\r\n        state.products = response\r\n    },\r\n    fillProductById(state,response){\r\n        state.productObj = {\r\n            generateUuid:'',\r\n            id : response.id,\r\n            name : response.name,\r\n            modelo : response.modelo,\r\n            brand : response.brand,\r\n            category_id : response.category_id,\r\n            quantity : response.quantity,\r\n            price : response.price,\r\n            peso : response.peso,\r\n            alto : response.alto,\r\n            ancho : response.ancho,\r\n            fondo : response.fondo,\r\n            statusProduct_id : response.statusProduct_id,\r\n            description : response.description,\r\n            parent_id:0,\r\n            description:response.description\r\n        }\r\n    },\r\n    fillCharacteristicByProductId(state,response){\r\n        let arrayOfCharacteristic = []\r\n       for (let index = 0; index < response.length; index++) {\r\n            const element = response[index]\r\n            arrayOfCharacteristic.push({\r\n                id:element.id,\r\n                characteristicName : element.characteristic,\r\n                state:'edit'\r\n            }) \r\n        }\r\n        state.characteristics = arrayOfCharacteristic\r\n    },\r\n    fillFileByProductId(state,response){\r\n        let arrayOfFile = []\r\n        for (let index = 0; index < response.length; index++) {\r\n            const element = response[index];\r\n            arrayOfFile.push({\r\n                id:element.id,\r\n                name:element.name,\r\n                file:'',\r\n                url:element.path,\r\n                uuid:'',\r\n                state:'old'\r\n            })\r\n        }\r\n        state.files = arrayOfFile\r\n    },\r\n    putImage(state,response){\r\n        var element = state.files[response.index]\r\n        var estado = 'new'\r\n        if(element.state == 'old'){\r\n            let objfileDelete = {\r\n                id: element.id,\r\n                url: element.url \r\n            }\r\n            state.fileForDelete.push(objfileDelete)\r\n            estado = 'new'\r\n        }\r\n        element.id = ''\r\n        element.name = ''\r\n        element.file = response.file\r\n        element.url = response.url\r\n        element.uuid = response.uuid\r\n        element.state = estado\r\n    },\r\n    deleteCharacteristic(state,objCharact){\r\n        var estado = objCharact.state\r\n        var index = objCharact.index\r\n        if(estado == 'edit' && state.characteristics[index].state == 'edit'){\r\n            // console.log(index)\r\n            state.characteristics[index].state = 'delete'\r\n        }else if(state.characteristics[index].state == 'new' || state.characteristics[index].state == 'delete'){\r\n            state.characteristics.splice(index,1);\r\n        }\r\n    },\r\n \r\n\r\n    //------------llenado de producto------------\r\n    generateUuid(state,AddProductObj){\r\n        state.productObj.generateUuid = AddProductObj\r\n    },\r\n    NameProduct (state, AddProductObj) {\r\n        state.productObj.name = AddProductObj\r\n    },\r\n    modeloProduct (state, AddProductObj) {\r\n        state.productObj.modelo = AddProductObj\r\n    },\r\n    quantityProduct (state, AddProductObj) {\r\n        state.productObj.quantity = AddProductObj\r\n    },\r\n    brandProduct (state, AddProductObj) {\r\n        state.productObj.brand = AddProductObj\r\n    },\r\n    priceProduct (state, AddProductObj) {\r\n        state.productObj.price = AddProductObj\r\n    },\r\n    category_idProduct (state, AddProductObj) {\r\n        state.productObj.category_id = AddProductObj\r\n    },\r\n    pesoProduct (state, AddProductObj) {\r\n        state.productObj.peso = AddProductObj\r\n    },\r\n    altoProduct (state, AddProductObj) {\r\n        state.productObj.alto = AddProductObj\r\n    },\r\n    anchoProduct (state, AddProductObj) {\r\n        state.productObj.ancho = AddProductObj\r\n    },\r\n    fondoProduct (state, AddProductObj) {\r\n        state.productObj.fondo = AddProductObj\r\n    },\r\n    parent_idProduct (state, AddProductObj) {\r\n        state.productObj.parent_id = AddProductObj\r\n    },\r\n    statusProduct_idProduct (state, AddProductObj) {\r\n        state.productObj.statusProduct_id = AddProductObj\r\n    },\r\n    updateDescription(state,AddProductObj){\r\n        state.productObj.description = AddProductObj\r\n    },\r\n    //---------------------------------------------------\r\n    //---------------adicionando imagen------------------\r\n  \r\n    deleteFileImage(state,index){\r\n        var element = state.files[index]\r\n        if(element.state == 'old'){\r\n            let objfileDelete = {\r\n                id: element.id,\r\n                name:element.name,\r\n                url: element.url \r\n            }\r\n            state.fileForDelete.push(objfileDelete)\r\n        }\r\n            state.files.splice(index,1)\r\n    },\r\n\r\n \r\n    CreateAndUpdateProductSubmit(state,productId){\r\n        state.productObj.id = productId\r\n    },\r\n    clearFields(state){\r\n        state.productObj = {\r\n            generateUuid:'',\r\n            id:null,\r\n            name: '',\r\n            modelo: '',\r\n            quantity:'',\r\n            brand:'',\r\n            price:'',\r\n            category_id:null,\r\n            peso:'',\r\n            alto:'',\r\n            ancho:'',\r\n            fondo:'',\r\n            parent_id:0,\r\n            statusProduct_id:null,\r\n            description:''\r\n        },    \r\n        state.categories=[],\r\n        state.status=[],\r\n        state.characteristics=[{\r\n            id:'',\r\n            characteristicName:'',\r\n            state:'new'\r\n        }],\r\n        state.files=[\r\n            {\r\n            id:'',\r\n            name:'',\r\n            file:'',\r\n            url:'',\r\n            uuid:'',\r\n            state:'new'\r\n        },\r\n        state.fileForDelete = []\r\n    ]\r\n    },\r\n    addFileImage(){\r\n        state.files.push({\r\n            id:'',\r\n            name:'',\r\n            file:'',\r\n            url:'',\r\n            uuid:'',\r\n            state:'new'\r\n        })\r\n    },\r\n    emptyFile(state,index){\r\n        var element = state.files[index]\r\n        if(element.state == 'old'){\r\n            let objfileDelete = {\r\n                id: element.id,\r\n                name:element.name,\r\n                url: element.url \r\n            }\r\n            state.fileForDelete.push(objfileDelete)\r\n        }\r\n        element.id = ''\r\n        element.url = ''\r\n        element.state = 'new'\r\n        element.uuid = ''\r\n    },\r\n    addingImageFirebase(state,objFile){\r\n        var resultadoNew = state.files.filter( file => file.state === 'new' );\r\n        var element = resultadoNew[objFile.index]\r\n        element.url = objFile.urlFirebase\r\n        element.name = objFile.name\r\n    },\r\n    CreateAndUpdateCharacteristic(state,objCharact){\r\n        state.characteristics[objCharact.index].id = objCharact.id\r\n    },\r\n    createAndUpdateFileProduct(state, objFile){\r\n        var element =state.files[objFile.index]\r\n        element.id = objFile.id\r\n        element.name = objFile.name\r\n    },\r\n    deleteImageFirebaseAndDataBase(state){\r\n        state.fileForDelete = []\r\n    }\r\n}\r\n\r\nconst actions = {\r\n    fillcategories(context){\r\n        axios.get(categoryUrl)\r\n        .then(response=>{\r\n            context.commit('fillcategories',response.data)\r\n        })\r\n    },\r\n    fillStatus(context){\r\n      axios.get(statusProductUrl)\r\n      .then(response=>{\r\n          context.commit('fillStatus',response.data)\r\n      })\r\n    },\r\n    fillProducts(context,auth){\r\n        axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth\r\n        axios.get(productUrl)\r\n        .then(response=>{\r\n            context.commit('fillProducts',response.data)\r\n        })\r\n    },\r\n    fillProductById(context,object){\r\n        // console.log('estoy en llenado de producto', object)\r\n        var auth = object.auth\r\n        var id  = object.id\r\n        axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth\r\n        axios.get(productUrl+'/'+id)\r\n        .then(response=>{\r\n            context.commit('fillProductById',response.data)\r\n        })\r\n        .catch(error=>{\r\n            console.log(error)\r\n        })\r\n    },\r\n    fillCharacteristicByProductId(context, object){\r\n        var auth = object.auth\r\n        var id =  object.id\r\n        axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth\r\n        axios.get(characteristicUrl+'/'+id)\r\n        .then(response=>{\r\n            context.commit('fillCharacteristicByProductId',response.data)\r\n        })\r\n        .catch(error=>{\r\n            console.log(error)\r\n        })\r\n    },\r\n    fillFileByProductId(context, object){\r\n        var auth = object.auth\r\n        var id =  object.id\r\n        axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth\r\n        axios.get(fileUrl+'/'+id)\r\n        .then(response=>{\r\n            context.commit('fillFileByProductId',response.data)\r\n        })\r\n        .catch(error=>{\r\n            console.log(error)\r\n        })\r\n    },\r\n    addFile(context,objFile){\r\n        context.commit('addFile',objFile)\r\n    },\r\n    deleteCharacteristic(context,objcharacteristic){\r\n            context.commit('deleteCharacteristic',objcharacteristic)\r\n    },\r\n    \r\n    deleteFileImage(context,number){\r\n        context.commit('deleteFileImage',number)\r\n    },\r\n    addFileImage(context){\r\n        context.commit('addFileImage')\r\n    },\r\n    emptyFile(context,index){\r\n        context.commit('emptyFile',index)\r\n    },\r\n    //creando en la base de datos\r\n    async CreateAndUpdateProductSubmit(context,object){\r\n        var auth = object.auth\r\n        var method = object.method\r\n        var id  = object.productId\r\n        var url = productUrl\r\n        if (method == 'put'){\r\n            url = productUrl + '/'+id\r\n        }\r\n        // console.log('number one')\r\n        // console.log(auth)\r\n        try{\r\n            const data = state.productObj\r\n            axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth\r\n            let response = await axios.post(url, {\r\n              name:             data.name,\r\n              modelo:           data.modelo,\r\n              quantity:         data.quantity,\r\n              brand:            data.brand,\r\n              price:            data.price,\r\n              category_id:      data.category_id,\r\n              peso:             data.peso,\r\n              alto:             data.alto,\r\n              ancho:            data.ancho,\r\n              fondo:            data.fondo,\r\n              parent_id:        0,\r\n              description:      data.description,\r\n              statusProduct_id: data.statusProduct_id,\r\n            })\r\n            if(response.data.create){\r\n                console.log('producto registrado con exito',response.data.create)\r\n            }\r\n            if(response.data.update){\r\n                console.log('producto actualizado con exito',response.data.update)\r\n            }\r\n            context.commit('CreateAndUpdateProductSubmit', response.data.product_id)\r\n            \r\n        }catch(ex){\r\n          console.log(ex)\r\n        }\r\n      },\r\n          //add image in farebase\r\n\r\n    uploadImageFirebase(context,fileForInsert){\r\n        return new Promise((resolve, reject) => {\r\n            for (let index = 0; index < fileForInsert.length; index++) {\r\n                const element = fileForInsert[index];\r\n                const uuid = element.uuid ;\r\n                // console.log('element', element)\r\n                // console.log('uuid', uuid)\r\n                // console.log(state.files[index])\r\n    \r\n                firebase.auth().signInWithEmailAndPassword(state.userFirebase,state.passFirebase)\r\n                .then(user => {\r\n                var storageRef =  firebase.storage().ref();\r\n                    var metadata = {\r\n                    contentType: element.file[0].type\r\n                    }\r\n                    const filename = element.file[0].name\r\n                    const ext = filename.slice(filename.lastIndexOf('.'))\r\n                    var uploadTask = storageRef.child('products/' + uuid + ext).put(element.file[0], metadata);\r\n\r\n                    uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, \r\n                    function(snapshot) {\r\n                        var progress =  (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n                        console.log('['+index+']'+'Upload is ' + progress + '% done');\r\n                        switch (snapshot.state) {\r\n                        case firebase.storage.TaskState.PAUSED: \r\n                            console.log('Upload is paused');\r\n                            break;\r\n                        case firebase.storage.TaskState.RUNNING: \r\n                            console.log('Upload is running');\r\n                            break;\r\n                        }\r\n                    }, function(error) {\r\n                    switch (error.code) {\r\n                        case 'storage/unauthorized':\r\n                        // User doesn't have permission to access the object\r\n                        break;\r\n\r\n                        case 'storage/canceled':\r\n                        // User canceled the upload\r\n                        break;\r\n\r\n                        case 'storage/unknown':\r\n                        // Unknown error occurred, inspect error.serverResponse\r\n                        break;\r\n                    }\r\n                    }, function complete () {\r\n                    // Upload completed successfully, now we can get the download URL\r\n                        uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {\r\n                            let objectFile={\r\n                                index: index,\r\n                                name: uuid + ext,\r\n                                urlFirebase:downloadURL\r\n                            }\r\n                            // //   console.log('tama;o Imagen', state.maxUploadImage-1)\r\n                            \r\n                            context.commit('addingImageFirebase',objectFile)\r\n                            console.log('File available at', downloadURL);\r\n                                if(fileForInsert.length == index+1){\r\n                                    console.log('entro para que siga el procedimiento')\r\n                                    resolve(true)\r\n                                }\r\n                        });\r\n                    })\r\n                })\r\n            }\r\n        })\r\n    },\r\n\r\n    addingImageFirebase(context){\r\n        return new Promise((resolve, reject) => {\r\n            var countFile = state.files.length\r\n            var resultadoNew = state.files.filter( file => file.state === 'new' );\r\n            if(resultadoNew.length>0){\r\n                context.dispatch('uploadImageFirebase',resultadoNew).then((response) => {\r\n                    if(response){\r\n                        resolve(true)\r\n                        console.log('entro a insertar la imagen')\r\n                    }\r\n                })\r\n            }else{\r\n                resolve(true)\r\n                console.log('no hay que subir')\r\n            }\r\n        })\r\n\r\n        // console.log('resultado de estado mew',resultado)\r\n        // console.log('resultado contador de files',countFile)\r\n            // for (let index = 0; index < state.files.length; index++) {\r\n            //     const element = state.files[index];\r\n            //     const uuid = state.files[index].uuid ;\r\n                // console.log('element', element)\r\n                // console.log('uuid', uuid)\r\n                // console.log(state.files[index])\r\n\r\n\r\n\r\n                // if(element.state == 'new' || element.state =='update'){\r\n                //     context.dispatch('uploadImageFirebase',element).then((response) => {\r\n                //         if(index == (state.files.length-1)){\r\n                //             resolve(true)\r\n                //         }\r\n                        \r\n                //     })\r\n                // }\r\n            // }\r\n      \r\n    },\r\n    CreateAndUpdateCharacteristic(context,object){\r\n        try{\r\n        var auth = object.auth\r\n        var id  = object.productId\r\n        var url = ''\r\n        axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth\r\n            for (let index = 0; index < state.characteristics.length; index++) {\r\n                const element = state.characteristics[index];\r\n                if(element.state =='edit'||element.state=='new'){\r\n                    if(element.state == 'edit'){\r\n                        url = characteristicUrl+'/'+element.id\r\n                    }else if(element.state =='new'){\r\n                        url = characteristicUrl\r\n                    }\r\n                    axios.post(url, {\r\n                        product_id:             state.productObj.id,\r\n                        characteristic:         element.characteristicName\r\n                    }).then(response=>{\r\n                        let objCharact={\r\n                            id:response.data.id,\r\n                            index : index\r\n                        }\r\n                        context.commit('CreateAndUpdateCharacteristic',objCharact)\r\n                        console.log('caracteristica '+response.data.type+' con exito', response.data )\r\n                    })\r\n                }else {\r\n                    url = characteristicUrl+'/'+element.id\r\n                    axios.delete(url).then(response=>{\r\n                        console.log('se elimino correctamente', response)\r\n                        let obj = {\r\n                            index : index,\r\n                            state :'delete'\r\n                          }\r\n                        // context.commit('deleteCharacteristic',obj)\r\n                        console.log('caracteristica '+response.data.type+' con exito', response.data )\r\n                    })\r\n                }\r\n            }\r\n        }catch(ex){\r\n          console.log(ex)\r\n        }\r\n      },\r\n      createAndUpdateFileProduct(context,object){\r\n          try{\r\n            var auth = object.auth\r\n            var url = fileUrl\r\n            axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth\r\n            for (let index = 0; index < state.files.length; index++) {\r\n                const element = state.files[index];\r\n                if(element.state == 'update' || element.state == 'new'){\r\n                    if(element.state == 'update'){\r\n                        url = url+'/'+element.id\r\n                    }\r\n                    axios.post(url, {\r\n                        product_id:     state.productObj.id,\r\n                        name:           element.name,\r\n                        path:           element.url\r\n                    }).then(response=>{\r\n                        let objCharact={\r\n                            id:response.id,\r\n                            name:response.name,\r\n                            index : index\r\n                        }\r\n                        context.commit('createAndUpdateFileProduct',objCharact)\r\n                        console.log('imagenes registradas con exito',response.data.saved)\r\n                    })\r\n                }\r\n            }\r\n          }catch(ex){\r\n            console.log(ex)\r\n          }\r\n      },\r\n      deleteImageFirebaseAndDataBase(context, object){\r\n        var auth = object.auth\r\n        if(state.fileForDelete.length > 0){\r\n            axios.defaults.headers.common['Authorization'] = 'Bearer ' + auth\r\n            firebase.auth().signInWithEmailAndPassword(state.userFirebase,state.passFirebase)\r\n            .then(user => {\r\n            for (let index = 0; index < state.fileForDelete.length; index++) {\r\n                const element = state.fileForDelete[index];\r\n                    var storage = firebase.storage();\r\n                    var storageRef = storage.ref();\r\n                    var desertRef = storageRef.child('/products/'+element.name);\r\n                    desertRef.delete().then(function() {\r\n                        console.log('se elimino correctamente de firebase su imagen')\r\n                    }).catch(function(error) {\r\n                    // Uh-oh, an error occurred!\r\n                    });\r\n                    axios.delete(fileUrl+'/'+element.id).then(response =>{\r\n                        console.log('imagen eliminada correctamente de la base de datos')\r\n                    })\r\n            }\r\n            context.commit('deleteImageFirebaseAndDataBase')\r\n            })\r\n        }\r\n      },\r\n      putImage(context,object){\r\n        context.commit('putImage',object)  \r\n      },\r\n      clearFields(context){\r\n        context.commit('clearFields')\r\n      },\r\n    \r\n      addCharacteristic(context){\r\n        context.commit('addCharacteristic')\r\n      }\r\n}\r\n\r\n\r\nexport default{\r\n    strict, state, getters, mutations, actions\r\n}\r\n"]}]}